{% extends "dashboards/provider_base.html" %}
{% load static %}

{% block title %}Dashboard - Doctor Academy{% endblock %}

{% block extra_head %}
<style>
/* ===== Cards Section ===== */
.stats-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.stats-card {
  border-radius: 15px;
  background: white;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  text-align: center;
}

.stats-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

.stats-card h5 {
  font-weight: 600;
  margin-bottom: 10px;
}

.stats-card p {
  font-size: 2rem;
  font-weight: 700;
  margin: 0;
}

/* ===== Latest Courses Table ===== */
.table-container {
  border-radius: 15px;
  overflow: hidden;
  background: white;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  padding: 20px;
}

.table-container table {
  width: 100%;
  border-collapse: collapse;
}

.table-container th, .table-container td {
  padding: 12px 15px;
  text-align: left;
}

.table-container thead {
  background-color: var(--primary-color);
  color: white;
}

.table-container tbody tr:hover {
  background-color: var(--bg-color);
  cursor: pointer;
}

.badge-active {
  background-color: var(--secondary-color);
  color: white;
  padding: 5px 10px;
  border-radius: 12px;
  font-size: 0.85rem;
}

.badge-inactive {
  background-color: #ccc;
  color: #333;
  padding: 5px 10px;
  border-radius: 12px;
  font-size: 0.85rem;
}
</style>
{% endblock %}

{% block content %}
<h2 class="mb-4" style="font-weight:700;">Welcome, {{ user.username }}!</h2>

<!-- Stats Cards -->
<div class="stats-cards">
  <div class="stats-card">
    <h5>Total Courses</h5>
    <p>{{ total_courses }}</p>
  </div>
  <div class="stats-card">
    <h5>Total Enrollments</h5>
    <p>{{ total_enrollments }}</p>
  </div>
  <div class="stats-card">
    <h5>Total Revenue</h5>
    <p>${{ total_revenue }}</p>
  </div>
  <div class="stats-card">
    <h5>Active Students</h5>
    <p>{{ total_students }}</p>
  </div>
</div>

<!-- Latest Courses Table -->
<div class="table-container">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h5 style="font-weight:600;">Your Courses</h5>
    <a href="{% url 'courses:course-create' %}" class="btn btn-primary">
      <i class="bi bi-plus-lg"></i> Add Course
    </a>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>#</th>
        <th>Course Name</th>
        <th>Enrollments</th>
        <th>Revenue</th>
        <th>Status</th>
        <th style="width:230px;">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for course in latest_courses %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ course.title }}</td>
        <td>{{ course.enrollments_count }}</td>
        <td>${{ course.revenue }}</td>
        <td>
          {% if course.is_active %}
            <span class="badge-active">Active</span>
          {% else %}
            <span class="badge-inactive">Inactive</span>
          {% endif %}
        </td>
        <td>
          <a href="{% url 'courses:course-units' course.id %}" class="btn btn-outline-primary btn-sm">Manage Units</a>
          <a href="{% url 'courses:course-edit' course.id %}" class="btn btn-outline-warning btn-sm">Edit</a>
          <a href="{% url 'courses:course-delete' course.id %}" class="btn btn-outline-danger btn-sm">Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6" class="text-center">No courses found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
